<div class="max-w-3xl min-h-screen mx-auto p-4 relative" @fadeInOut>
  <h2 class="text-2xl font-bold mb-4 text-center">Product List</h2>

  <!-- Three Lines Button / X Button -->
  <div class="absolute top-4 right-6 z-50">
    <button (click)="toggleSidebar()" class="text-gray-600 hover:text-gray-900 transition focus:outline-none">
      <ng-container *ngIf="!isSidebarOpen; else closeIcon">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </ng-container>
      <ng-template #closeIcon>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </ng-template>
    </button>
  </div>

  <!-- Sidebar -->
  <div
    class="absolute top-10 right-4 bg-white shadow-lg border border-gray-300 rounded-lg z-40 transition-opacity transform"
    [ngClass]="{ 'opacity-0': !isSidebarOpen, 'opacity-100': isSidebarOpen }"
    style="height: auto; width: 200px;">
    <div class="p-4 text-right">
      <button (click)="selectAll()" [disabled]="!isSidebarOpen"
        class="block text-green-500 hover:text-green-700 py-2">Select All</button>
      <button (click)="deselectAll()" [disabled]="!isSidebarOpen"
        class="block text-red-500 hover:text-red-700 py-2">Deselect All</button>
    </div>
  </div>

  Search Bar
  <div class="flex justify-between items-center mb-4">
    <input type="text" [(ngModel)]="searchText" (input)="filterProducts()" placeholder="Search products..."
      class="border border-gray-300 rounded-lg p-2 flex-grow" />
  </div>

  <!-- Table to display the products -->
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-300 rounded-lg">
      <thead>
        <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
          <th class="py-3 px-6 text-left w-1/6"></th>
          <th class="py-3 px-6 text-left w-3/6">Name</th>
          <th class="py-3 px-6 text-left w-1/6">Row</th>
          <th class="py-3 px-6 text-center w-1/6">Actions</th>
        </tr>
      </thead>
      <tbody [@listAnimation]="filteredProducts.length" class="text-gray-600 text-sm font-light">
        <tr *ngFor="let product of filteredProducts" [class.line-through]="!product.checked"
          [class.text-gray-500]="!product.checked" class="border-b border-gray-200 hover:bg-gray-100"
          [ngClass]="{ 'opacity-50': !product.checked }">
          <td class="py-3 px-6 text-left w-1/6" (click)="toggleCheckbox(product)">
            <label class="cursor-pointer">
              <input type="checkbox" id="green-checkbox" [(ngModel)]="product.checked" (change)="onCheckboxChange()"
                class="w-4 h-4 accent-green-600 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
            </label>
          </td>
          <td class="py-3 px-6 text-left w-3/6">{{ product.product_name }}</td>
          <td class="py-3 px-6 text-left w-1/6">{{ product.row_num }}</td>
          <td class="py-3 px-6 text-center w-1/6">
            <!-- Link to Edit Product -->
            <a [routerLink]="['/edit', product.product_id]" class="text-blue-500 hover:text-blue-700 transition">
              Edit
            </a>
          </td>
        </tr>
        <!-- Add New Product Row -->
        <tr class="border-b border-gray-200">
          <td colspan="4" class="py-3 px-6 text-center">
            <a [routerLink]="['/create', { name: searchText }]"
              class="bg-white text-gray-900 border border-gray-300 px-4 py-2 rounded hover:bg-gray-100 transition inline-flex items-center font-medium rounded-lg focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              Add {{ searchText ? searchText : 'New Product' }}
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <button (click)="updateCheckedStatus()" [class.hidden]="!isSaveButtonVisible"
    class="absolute bottom-4 right-4 bg-green-500 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-green-600 hidden">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
    </svg>
  </button>
</div>